# vi: ft=config

# launch and OS bindings
ctrl + alt + cmd - k: /Applications/Kitty.app/Contents/MacOS/kitty --listen-on unix:/tmp/mykitty --single-instance -d ~/Code
ctrl + alt + cmd - n: echo "launch zsh -ci \"nvim -c 'Explore'\"" | /Applications/Kitty.app/Contents/MacOS/kitty --listen-on unix:/tmp/mykitty --session=- -d ~/Documents/Notes
ctrl + alt + cmd - d: echo "launch zsh -ci \"nvim -c 'Explore'\"" | /Applications/Kitty.app/Contents/MacOS/kitty --listen-on unix:/tmp/mykitty --session=- -d ~/Code/dotfiles
ctrl + alt + cmd - e: alias ejectall='osascript -e "tell application \"Finder\" to eject (every disk whose ejectable is true)"'

cmd - y: launchctl kickstart -k "gui/${UID}/homebrew.mxcl.yabai" && launchctl kickstart -k "gui/${UID}/homebrew.mxcl.skhd"

# misc single commands
shift + ctrl - d: dark-mode
shift + ctrl - j: yabai -m display --focus next || yabai -m display --focus prev
shift + ctrl - s: zsh -c -i "$HOME/.config/skhd/cycle-layouts.sh"
shift + ctrl - f: yabai -m space --layout float
 shift + cmd - f: yabai -m window --toggle native-fullscreen
         alt - 0: yabai -m space --balance && yabai -m space --padding abs:$WM_SPACING:$WM_SPACING:$WM_SPACING:$WM_SPACING && yabai -m space --gap abs:$WM_SPACING
         alt - a: yabai -m config auto_balance $([ "$(yabai -m config auto_balance)" = off ] && echo "on" || echo "off")
         alt - r: yabai -m space --rotate 90
 alt + shift - s: yabai -m space --padding rel:-$WM_SPACING:-$WM_SPACING:-$WM_SPACING:-$WM_SPACING
         alt - s: yabai -m space --padding rel:$WM_SPACING:$WM_SPACING:$WM_SPACING:$WM_SPACING
 alt + shift - v: yabai -m space --padding rel:0:0:-$WM_SPACING:-$WM_SPACING
         alt - v: yabai -m space --padding rel:0:0:$WM_SPACING:$WM_SPACING
 alt + shift - g: yabai -m space --gap rel:-$WM_SPACING
         alt - g: yabai -m space --gap rel:$WM_SPACING
         alt - x: yabai -m space --mirror x-axis
         alt - y: yabai -m space --mirror y-axis

# toggle transparency
alt - t: if [[ "$(yabai -m config normal_window_opacity)" -lt 1 ]]; then \
           yabai -m config normal_window_opacity 1.0; \
           yabai -m config window_opacity off; \
         else; \
           yabai -m config window_opacity on; \
           yabai -m config normal_window_opacity $WM_OPACITY; \
        fi

# various window commands
shift + alt - f: yabai -m window --toggle zoom-fullscreen
shift + alt - c: yabai -m window --toggle float && yabai -m window --grid 16:16:11:11:5:5
shift + alt - m: yabai -m window --toggle float && yabai -m window --grid 16:16:2:0:12:16

# focus window
alt - h: yabai -m window --focus $([ "$(yabai -m query --spaces | jq -r 'map(select(."has-focus" == true))[0].type')" = stack ] && echo stack.prev || echo west)
alt - j: yabai -m window --focus $([ "$(yabai -m query --spaces | jq -r 'map(select(."has-focus" == true))[0].type')" = stack ] && echo stack.next || echo south)
alt - k: yabai -m window --focus $([ "$(yabai -m query --spaces | jq -r 'map(select(."has-focus" == true))[0].type')" = stack ] && echo stack.next || echo north)
alt - l: yabai -m window --focus $([ "$(yabai -m query --spaces | jq -r 'map(select(."has-focus" == true))[0].type')" = stack ] && echo stack.next || echo east)

# move window
shift + alt - h: yabai -m window --warp west
shift + alt - j: yabai -m window --warp south
shift + alt - k: yabai -m window --warp north
shift + alt - l: yabai -m window --warp east

# move window
shift + cmd - h: yabai -m window --swap west
shift + cmd - j: yabai -m window --swap south
shift + cmd - k: yabai -m window --swap north
shift + cmd - l: yabai -m window --swap east

# resize windows
shift + alt - left:         yabai -m window --resize left:-$WM_SPACING:0
shift + alt + ctrl - left:  yabai -m window --resize left:$WM_SPACING:0
shift + alt - right:        yabai -m window --resize right:$WM_SPACING:0
shift + alt + ctrl - right: yabai -m window --resize right:-$WM_SPACING:0
shift + alt - up:           yabai -m window --resize top:0:-$WM_SPACING
shift + alt + ctrl - up:    yabai -m window --resize top:0:$WM_SPACING
shift + alt - down:         yabai -m window --resize bottom:0:$WM_SPACING
shift + alt + ctrl - down:  yabai -m window --resize bottom:0:-$WM_SPACING

# set window insert
cmd + alt - k: yabai -m window --insert north
cmd + alt - h: yabai -m window --insert west
cmd + alt - l: yabai -m window --insert east
cmd + alt - j: yabai -m window --insert south

# send window to prev/next space, create new space if first/last index
shift + alt - p: if [[ "$(yabai -m query --spaces --display | jq '.[0].index')" -lt "$(yabai -m query --spaces --space | jq '.index')" ]]; then \
                   yabai -m window --space prev && yabai -m space --focus prev; \
                 else; \
                   yabai -m space --create && \
                   index="$(yabai -m query --spaces --display \
                   | jq 'map(select(."is-native-fullscreen" == false))[-1].index')" && \
                   yabai -m window --space "$index" && yabai -m space --focus "$index"; \
                   yabai -m space --move "$(yabai -m query --spaces --display | jq '.[0].index')"; \
                 fi; \
                   yabai -m window --focus last
shift + alt - n: if [[ "$( yabai -m query --spaces --display | jq '.[-1].index' )" -gt \
                   "$(yabai -m query --spaces --space | jq '.index')" ]]; then \
                   yabai -m window --space next && \
                   yabai -m space --focus next; \
                 else; \
                   yabai -m space --create && \
                   index="$(yabai -m query --spaces --display \
                   | jq 'map(select(."is-native-fullscreen" == false))[-1].index')" && \
                   yabai -m window --space "$index" && \
                   yabai -m space --focus "$index"; \
                 fi; \
                   yabai -m window --focus last

# send window to new first/last space on monitor
shift + alt - b: yabai -m space --create && \
                 query="$(yabai -m query --spaces --display \
                 | jq 'map(select(."is-native-fullscreen" == false))')" && \
                 last="$(echo $query | jq '.[-1].index')" && \
                 first="$(echo $query | jq '.[0].index')" && \
                 yabai -m window --space "$last" && \
                 yabai -m space --focus "$last" && \
                 yabai -m space --move "$first"
shift + alt - e: yabai -m space --create && \
                 index="$(yabai -m query --spaces --display \
                 | jq 'map(select(."is-native-fullscreen" == false))[-1].index')" && \
                 yabai -m window --space "$index" && \
                 yabai -m space --focus "$index"

# send window to space and follow focus
shift + alt - 1: yabai -m window --space 1 && yabai -m space --focus 1
shift + alt - 2: yabai -m window --space 2 && yabai -m space --focus 2
shift + alt - 3: yabai -m window --space 3 && yabai -m space --focus 3
shift + alt - 4: yabai -m window --space 4 && yabai -m space --focus 4
shift + alt - 5: yabai -m window --space 5 && yabai -m space --focus 5
shift + alt - 6: yabai -m window --space 6 && yabai -m space --focus 6

# send window to monitor and follow focus
shift + alt - m: begin; yabai -m window --display prev && yabai -m display --focus prev; end || begin; yabai -m window --display next && yabai -m display --focus next; end

# send space to monitor and follow focus
shift + ctrl - m: yabai -m space --display next || yabai -m space --display prev

# move space
shift + ctrl - p: [[ "$(yabai -m query --spaces --display | jq '.[0].index')" -lt "$(yabai -m query --spaces --space | jq '.index')" ]] && yabai -m space --move prev
shift + ctrl - n: [[ "$(yabai -m query --spaces --display | jq '.[-1].index')" -gt "$(yabai -m query --spaces --space | jq '.index')" ]] && yabai -m space --move next

# move space to first/last index of monitor
shift + ctrl - b: yabai -m space --move "$(yabai -m query --spaces --display | jq 'map(select(."is-native-fullscreen" == false))[0].index')"
shift + ctrl - e: yabai -m space --move "$(yabai -m query --spaces --display | jq 'map(select(."is-native-fullscreen" == false))[-1].index')"

# focus space
shift + ctrl - h: yabai -m space --focus prev
shift + ctrl - l: yabai -m space --focus next
shift + ctrl - 1: yabai -m space --focus 1
shift + ctrl - 2: yabai -m space --focus 2
shift + ctrl - 3: yabai -m space --focus 3
shift + ctrl - 4: yabai -m space --focus 4
shift + ctrl - 5: yabai -m space --focus 5
shift + ctrl - 6: yabai -m space --focus 6
shift + ctrl - 7: yabai -m space --focus 7
shift + ctrl - 8: yabai -m space --focus 8
shift + ctrl - 9: yabai -m space --focus 9

# create space and focus it
shift + ctrl - c: yabai -m space --create && index="$(yabai -m query --spaces --display | jq 'map(select(."is-native-fullscreen" == false))[-1].index')" && yabai -m space --focus "$index"

# destroy space
shift + ctrl - w: yabai -m space --destroy
